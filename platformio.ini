[platformio]
default_envs = esp32

[env:native]
platform = native
test_filter = test_native
test_ignore = test_embedded
build_flags = 
    -D MQTT_PROTOCOL_5
; Only build URI utilities for native tests to avoid ESP-IDF dependencies
build_src_filter = +<UriUtils.cpp>
test_build_src = yes

[env:esp8266]
platform = espressif8266
board = nodemcuv2
framework = arduino
test_filter = test_embedded
test_ignore = test_native
build_flags = 
    -D MQTT_PROTOCOL_5
    -D CONFIG_MQTT_PROTOCOL_5
monitor_speed = 115200

[env:esp32]
platform = espressif32
board = esp32dev
framework = arduino
test_filter = test_embedded
test_ignore = test_native
build_flags =
monitor_speed = 115200